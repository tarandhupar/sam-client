<div class="usa-grid search-page">

  <!--filters aside-->
  <aside class="usa-width-one-third">

    <div>&nbsp;</div>
    <!-- <div sam-sticky limit=1200 container="occupy-page"> -->
    <div>
      <sam-filters-container>
        <sam-collapsible *ngIf="index !== 'fh' && showRegionalOffices==false" [label]="'Status'" [startOpened]="true">
          <!--active checkbox-->
          <sam-checkbox
            [(model)]="checkboxModel"
            [name]="checkboxConfig.name"
            [options]="checkboxConfig.options"
            [label]="checkboxConfig.label"
            [hint]="checkboxConfig.hint"
            [errorMessage]="checkboxConfig.errorMessage"
            [hasSelectAll]="checkboxConfig.hasSelectAll"
            (modelChange)="activeFilter($event)">
          </sam-checkbox>
          <span *ngIf="index === 'ei'">Note: Only non-active registrations will be added</span>
        </sam-collapsible>

        <sam-collapsible *ngIf="index === 'ei' && showRegionalOffices==false" [label]="'Entity Type'" [startOpened]="true">
          <!--active checkbox-->
          <sam-checkbox
            [model]="registrationExclusionCheckboxModel"
            [name]="registrationExclusionCheckboxConfig.name"
            [options]="registrationExclusionCheckboxConfig.options"
            [label]="registrationExclusionCheckboxConfig.label"
            (modelChange)="registrationExclusionCheckboxFilter($event)">
          </sam-checkbox>
        </sam-collapsible>

        <sam-collapsible *ngIf="showRegionalOffices==true" [label]="'Keyword'" [startOpened]="true">
          <sam-autocomplete class="search-bar sam-autocomplete-width usa-regional-filter" autofill-suggestions
                            [(ngModel)]="ro_keyword"
                            (ngModelChange)="regionalOfficeSearchEvent($event)"
                            [index]="'ro'"
                            [id]="'regional-office'"
                            [showClearButton]="true"
                            [allowAny]="true"
                            [config]="regionalType"
                            name="regionalsearch">
          </sam-autocomplete>
        </sam-collapsible>

        <sam-collapsible [label]="'Federal Organizations'" [startOpened]="true" *ngIf="index !=='wd' && index !=='ei'">
          <sam-agency-picker #agencyPicker
            [attr.id] = "'federal-organization-filter'"
            [label]="'Search Federal Organizations'"
            (organization)="onOrganizationChange($event)"
            [levelLimit] = '2'>
          </sam-agency-picker>
        </sam-collapsible>

        <sam-collapsible  [label]="'Wage Determination Type'" [startOpened]="true" *ngIf="index === 'wd' && showRegionalOffices==false">
          <!--wage determination DBA or SCA radio buttons-->
          <sam-radio-button
            [(model)]="wdTypeModel"
            [options]="wdTypeConfig.options"
            [label]="wdTypeConfig.label"
            [hint]="wdTypeConfig.hint"
            [name]="wdTypeConfig.name"
            [errorMessage]="wdTypeConfig.errorMessage"
            (modelChange)="wdFilterChange($event)">
          </sam-radio-button>
        </sam-collapsible>

        <!--Location Filter-->
        <sam-collapsible [label]="'Location'" [startOpened]="true" *ngIf="index === 'wd' && showRegionalOffices==false && wdTypeModel">
          <!--state autocomplete-->
          <sam-autocomplete [ngModel]="wdStateObject"
                            (ngModelChange)="stateChange($event)"
                            [name]="selectStateConfig.name"
                            [id]="selectStateConfig.name"
                            [labelText]="selectStateConfig.label"
                            [hint]="selectStateConfig.hint"
                            [options]="selectStateConfig.options"
                            [config]="selectStateConfig"
                            [disabled]="selectStateConfig.disabled">
          </sam-autocomplete>
          <!--county autocomplete-->
          <sam-autocomplete [ngModel]="countyObject"
                            (ngModelChange)="countyChange($event)"
                            [name]="selectCountyConfig.name"
                            [id]="selectCountyConfig.name"
                            [labelText]="selectCountyConfig.label"
                            [hint]="selectCountyConfig.hint"
                            [options]="selectCountyConfig.options"
                            [config]="selectStateConfig"
                            [disabled]="selectCountyConfig.disabled">
          </sam-autocomplete>
        </sam-collapsible>




        <!--*** DBA Specif Filters ***-->
        <sam-collapsible [label]="'DBA: Construction Type'" [startOpened]="true" *ngIf="index === 'wd' && wdTypeModel === 'dbra' && showRegionalOffices==false">

          <!--construction type drop down-->
          <sam-autocomplete [ngModel]="wdConstructObject"
                            (ngModelChange)="constructionTypeChange($event)"
                            [name]="selectConstructConfig.name"
                            [id]="selectConstructConfig.name"
                            [labelText]="selectConstructConfig.label"
                            [hint]="selectConstructConfig.hint"
                            [options]="selectConstructConfig.options"
                            [config]="selectConstructConfig"
                            [disabled]="selectConstructConfig.disabled">

          </sam-autocomplete>
        </sam-collapsible>

        <!--*** SCA Specific Filters ***-->
        <sam-collapsible [label]="'SCA: Previously Performed'" [startOpened]="true" *ngIf="index === 'wd' && wdTypeModel === 'sca' && showRegionalOffices==false">

          <!--previously performed-->
          <sam-radio-button
            [(model)]="wdPreviouslyPerformedModel"
            [options]="wdPreviouslyPerformedConfig.options"
            [label]="wdPreviouslyPerformedConfig.label"
            [hint]="wdPreviouslyPerformedConfig.hint"
            [name]="wdPreviouslyPerformedConfig.name"
            [errorMessage]="wdPreviouslyPerformedConfig.errorMessage"
            (modelChange)="wdPreviouslyPerformedChanged($event)">
          </sam-radio-button>
        </sam-collapsible>

        <sam-collapsible [label]="'SCA: Subject to CBA'" [startOpened]="true"
                         *ngIf="index === 'wd' && wdTypeModel === 'sca' && wdPreviouslyPerformedModel === 'prevPerfYesLocality' && showRegionalOffices==false">

          <!--Subject to CBA-->
          <sam-radio-button
            [(model)]="wdSubjectToCBAModel"
            [options]="wdSubjectToCBAConfig.options"
            [label]="wdSubjectToCBAConfig.label"
            [hint]="wdSubjectToCBAConfig.hint"
            [name]="wdSubjectToCBAConfig.name"
            [errorMessage]="wdSubjectToCBAConfig.errorMessage"
            (modelChange)="wdSubjectToCBAChanged($event)">
          </sam-radio-button>
        </sam-collapsible>

        <sam-collapsible [label]="'SCA: Non-Standard Services'" [startOpened]="true"
                         *ngIf="index === 'wd' && wdTypeModel === 'sca' && (wdPreviouslyPerformedModel === 'prevPerfYesDifferentLocality' || wdPreviouslyPerformedModel === 'prevPerfNo') || wdSubjectToCBAModel === 'noCBA'  && showRegionalOffices==false">

          <!--Non-Standard Services radio buttons-->
          <sam-radio-button *ngIf="wdPreviouslyPerformedModel !== 'prevPerfNo'"
            [(model)]="wdNonStandardRadModel"
            [options]="wdNonStandardRadConfig.optionsWithEven"
            [label]="wdNonStandardRadConfig.label"
            [hint]="wdNonStandardRadConfig.hint"
            [name]="wdNonStandardRadConfig.name"
            [errorMessage]="wdNonStandardRadConfig.errorMessage"
            (modelChange)="wdNonStandardRadChanged($event)">
          </sam-radio-button>

          <sam-radio-button *ngIf="wdPreviouslyPerformedModel === 'prevPerfNo'"
                            [(model)]="wdNonStandardRadModel"
                            [options]="wdNonStandardRadConfig.optionsWithoutEven"
                            [label]="wdNonStandardRadConfig.label"
                            [hint]="wdNonStandardRadConfig.hint"
                            [name]="wdNonStandardRadConfig.name"
                            [errorMessage]="wdNonStandardRadConfig.errorMessage"
                            (modelChange)="wdNonStandardRadChanged($event)">
          </sam-radio-button>

          <!--Non-Standard Services drop down select-->
          <sam-autocomplete [ngModel]="wdNonStandardSelectObject"
                            (ngModelChange)="wdNonStandardSelectChanged($event)"
                            [options]="wdNonStandardSelectConfig.options"
                            [config]="wdNonStandardSelectConfig"
                            [labelText]="wdNonStandardSelectConfig.label"
                            [name]="wdNonStandardSelectConfig.name"
                            [id]="wdNonStandardSelectConfig.name"
                            [hint]="wdNonStandardSelectConfig.hint"
                            [disabled]="wdNonStandardSelectConfig.disabled">
          </sam-autocomplete>
        </sam-collapsible>

        <!--Awards specific Filters-->
        <sam-collapsible  [label]="'Contract Type'" [startOpened]="true" *ngIf="index==='fpds' && showRegionalOffices==false">
          <sam-radio-button
            [(model)]="awardIDVModel"
            [options]="awardIDVRadConfig.options"
            [label]="awardIDVRadConfig.label"
            [hint]="awardIDVRadConfig.hint"
            [name]="awardIDVRadConfig.name"
            [errorMessage]="awardIDVRadConfig.errorMessage"
            (modelChange)="awardIDVRadChanged($event)">
          </sam-radio-button>
          <br/>
          <sam-contract-type-filter [attr.id]="'award-idv-type-filter'"
                                    [contractValues]="awardTypeModel"
                                    (contractValuesChange)="awardTypeSelected($event)"
                                    [contractOptions]="awardType.options"
                                    [contractConfig]="awardType"
                                    class="usa-award-filter award-type-dropdown-list">
          </sam-contract-type-filter>
          <br/>
          <sam-contract-type-filter [attr.id]="'contract-type-filter'"
                                    class="usa-award-filter contract-type-dropdown-list"
                                    [contractValues]="contractTypeModel"
                                    (contractValuesChange)="contractTypeSelected($event)"
                                    [contractOptions]="contractType.options"
                                    [contractConfig]="contractType">
          </sam-contract-type-filter>
        </sam-collapsible>

        <!--Entity Name - DUNS Filter-->
        <sam-collapsible [label]="'Entity Name/UEI'" [startOpened]="true" *ngIf="index==='fpds' || index === 'opp' || index === 'ei'">
          <sam-autocomplete-multiselect autofill-entityduns
                                        class="usa-award-filter"
                                        [attr.id]="'entityDuns'"
                                        [label]="'Entity Name/UEI'"
                                        [name]="'Test'"
                                        [ngModel]="dunsModelList"
                                        (ngModelChange)="dunsModelChange($event)"
                                        [keyValueConfig]="dunsConfiguration.keyValueConfig">

          </sam-autocomplete-multiselect>
        </sam-collapsible>

        <!--NAICS - PSC Filters-->
        <sam-collapsible [label]="'Service Classifications'" [startOpened]="true" *ngIf="(index==='fpds' || index === 'opp' || index === 'ei') && showRegionalOffices==false">
          <sam-naics-psc-filter [attr.id]= "'naics-psc-filter'"
                                [pscValues]="pscTypeModel"
                                (pscValuesChange)="pscTypeSelected($event)"
                                [pscOptions]="pscType.options"
                                [pscConfig]="pscType"
                                [naicsValues]="naicsTypeModel"
                                (naicsValuesChange)="naicsTypeSelected($event)"
                                [naicsOptions]="naicsType.options"
                                [naicsConfig]="naicsType">
          </sam-naics-psc-filter>
        </sam-collapsible>

        <sam-collapsible [label]="'Federal Organizations'" [startOpened]="true" *ngIf="index ==='ei'">
          <sam-agency-picker #agencyPicker
                             [attr.id] = "'federal-organization-filter-ei'"
                             [label]="'Search Federal Organizations'"
                             (organization)="onOrganizationChange($event)"
                             [levelLimit] = '2'>
          </sam-agency-picker>
          <span>Note: Only Exclusions are associated</span>
        </sam-collapsible>

        <!--Eligibility - Filter-->
        <sam-collapsible [label]="'Eligibility'" [startOpened]="true" *ngIf="(index==='cfda')">
          <sam-eligibility-filter [attr.id]="'eligibility-filter'"
                                  [beneficiaryValues]="benElSearchString"
                                  (beneficiaryValuesChange)="benElSelected($event)"
                                  [beneficiaryOptions]="benElType.options"
                                  [beneficiaryConfig]="benElType"
                                  [applicantValues]="appElSearchString"
                                  (applicantValuesChange)="appElSelected($event)"
                                  [applicantOptions]="appElType.options"
                                  [applicantConfig]="appElType">
          </sam-eligibility-filter>
        </sam-collapsible>

        <!--Assistance Type Filters-->
        <sam-collapsible [label]="'Assistance Type'" [startOpened]="true" *ngIf="index==='cfda' && showRegionalOffices==false">
          <sam-contract-type-filter [attr.id]= "'assistance-type-filter'"
                                    class="usa-award-filter award-type-dropdown-list"
                                    [contractValues]="assistanceTypeFilterModel"
                                    (contractValuesChange)="assistanceTypeFilterSelected($event)"
                                    [contractOptions]="assistanceTypeOptions.options"
                                    [contractConfig]="assistanceTypeOptions">
          </sam-contract-type-filter>
        </sam-collapsible>
        <div class ="sam-ui section divider"></div>
        <button (click)='clearAllFilters()'>Clear All</button>
      </sam-filters-container>
    </div>
  </aside>

  <div class="usa-width-two-thirds">
    <div class="usa-width-one">
      <sam-alert *ngIf="index==='wd' && !dismissWdAlert" [type]="'info'" [showClose]="'true'" [title]="'Wage Determinations Search'" (dismiss)="dismissWdAlert=true"><div [innerHTML]="wdSearchDescription"></div></sam-alert>

      <h1 *ngIf="!showRegionalOffices" class="m_T-0 p_T-6x">Search Results</h1>
      <h1 *ngIf="showRegionalOffices" class="m_T-0 p_T-6x">Federal Assistance Regional Agency Locations</h1>

      <p *ngIf="wdSubjectToCBAModel === 'yesBasedCBA' || wdSubjectToCBAModel === 'yesUnbasedCBA'" class="usa-font-lead">
        Please navigate to the <a href="https://www.wdol.gov/sca.aspx">Service Contract Act</a> section of the legacy WDOL site to retrieve
        a Collective Bargaining Agreement (CBA) WD or to create a new CBA WD
      </p>
    </div>
    <div class="usa-width-one" *ngIf="wdSubjectToCBAModel !== 'yesBasedCBA' && wdSubjectToCBAModel !== 'yesUnbasedCBA'">

      <fh-featured-result *ngFor="let row of featuredData.featuredResult" [data]="row" [qParams]="qParams"></fh-featured-result>

      <strong>
        <list-results-message *ngIf="isSearchComplete && totalCount > 0 && wdSubjectToCBAModel !== 'yesBasedCBA' && wdSubjectToCBAModel !== 'yesUnbasedCBA'" [showing]="10" [currentPage]="pageNum+1" [total]="totalCount" [suffix]="listMessageSuffix"></list-results-message>
      </strong>

      <div class="sam-ui hidden divider"></div>

      <div *ngIf= "isSearchComplete" id="search-results">
        <div tabindex="-1" *ngFor="let row of data.results">

          <opportunities-result *ngIf="row._type=='opportunity'" class="usa-grid-full" [data]="row" [qParams]="qParams"></opportunities-result>

          <assistance-listing-result  *ngIf="row._type=='assistanceListing'" [data]="row" [qParams]="qParams"></assistance-listing-result>

          <federal-hierarchy-result  *ngIf="row._type=='federalOrganization'" class="usa-grid-full" [data]="row" [qParams]="qParams"></federal-hierarchy-result>
          <entities-result *ngIf="row._type=='entity'" class="usa-grid-full" [data]="row" [qParams]="qParams"></entities-result>
          <exclusions-result *ngIf="row._type=='exclusion'" class="usa-grid-full" [data]="row" [qParams]="qParams"></exclusions-result>
          <wage-determination-result *ngIf="row._type=='wdSCA'|| row._type=='wdDBRA'" class="usa-grid-full" [data]="row" [qParams]="qParams"></wage-determination-result>
          <awards-result *ngIf="row._type=='award'" class="usa-grid-full" [data]="row" [qParams]="qParams"></awards-result>
          <regional-office-listing-result *ngIf="showRegionalOffices" class="usa-grid-full" [data]="row" [qParams]="qParams" ></regional-office-listing-result>
          <div class="sam-ui section divider"></div>
        </div>
      </div>
      <div class="search-inactive-results" *ngIf="(!initLoad && isSearchComplete && !data.results && index !== 'wd' && (index == 'fh' || showRegionalOffices || !isActive))">
        <p>No results found for '<span class = 'no-results-found' [innerText]="oldKeyword"></span>'</p>
        <div style="height:300px;"></div>
      </div>
      <div class="search-inactive-results" *ngIf="(!initLoad && isSearchComplete && !data.results && index !== 'wd' && index !== 'fh' && !showRegionalOffices && isActive)">
        <p>Your search did not return any results for active records. Would you like to include inactive records in your search results? <a href= "javascript:void(0)" (click)="findInactiveResults()" >[Yes]</a></p>
      </div>

      <div *ngIf="!initLoad && !data.results && index === 'wd'">
        <h3>No Wage Determinations were found using the criteria you have selected.</h3>
        <h3>If you would like to request a SCA WDOL using an e98 form, please click <a href="https://www.dol.gov/whd/govcontracts/sca/sf98/index.asp">here.</a></h3>
        <div style="height:300px;"></div>
      </div>
    </div>
    <div *ngIf="data.results && isSearchComplete">
      <div class="usa-width-one-whole" *ngIf="wdSubjectToCBAModel !== 'yesBasedCBA' && wdSubjectToCBAModel !== 'yesUnbasedCBA'">
        <sam-pagination (pageChange)="pageChange($event-1)" [currentPage]="pageNum+1" [totalPages]="totalPages"></sam-pagination>
      </div>
    </div>
    <br/><br/>
  </div>

</div>
