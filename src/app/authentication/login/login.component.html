<div class="usa-authentication usa-login">
  <div class="usa-grid" *ngIf="isStage(1)">
    <div class="usa-width-one-half">
      <h1>I have a PIV or CAC card</h1>
      <span>Government Employees only: Please insert your card then click the button below</span>

      <h2>Coming Soon</h2>

      <div class="button_wrapper">
        <button class="usa-button-gray">Sign in With Card</button>
      </div>
    </div>
    <div class="usa-width-one-half">
      <h1>Sign In</h1>

      <form class="usa-form form-login" autocomplete="off" [formGroup]="form" (ngSubmit)="submit($event)">
        <fieldset>
          <div class="usa-input-error-message" *ngIf="isErrors() && states.submitted">{{ errors.global[0] }}</div>

          <div formGroupName="stage1" [ngClass]="{ 'usa-input-error': errors.username.length && states.submitted }">
            <label for="signin-username">Email</label>
            <span class="usa-input-error-message" *ngIf="errors.username.length && states.submitted" role="alert">{{ errors.username[0] }}</span>
            <input type="text" id="signin-username" autocomplete="off" formControlName="username" readonly="readonly" onfocus="this.removeAttribute('readonly');"/>
          </div>

          <div formGroupName="stage1" [ngClass]="{ 'usa-input-error': errors.password.length && states.submitted }">
            <label for="signin-password">Password</label>
            <span class="usa-input-error-message" *ngIf="errors.password.length && states.submitted" role="alert">{{ errors.password[0] }}</span>
            <input type="{{ states.password.type }}" id="signin-password" formControlName="password" readonly="readonly"  onfocus="this.removeAttribute('readonly');" />
          </div>

          <p class="usa-form-note">
            <a title="Show password" href="javascript:void(0);" class="usa-show_password" aria-controls="password" (click)="togglePassword()">
              {{ (states.password.type == 'password') ? 'Show' : 'Hide'  }} Password
            </a>
          </p>

          <div class="usa-button-controls">
            <button type="submit" [disabled]="states.loading">Sign In</button>
          </div>

          <div class="usa-grid usa-links">
            <div class="usa-width-one-half text-center">
              <a title="Forgot Password?" routerLink="/forgot">Forgot Password?</a>
            </div>
            <div class="usa-width-one-half text-center">
              <a title="Sign Up" routerLink="/signup">Sign Up</a>
            </div>
          </div>
        </fieldset>
      </form>
    </div>
  </div>

  <div class="usa-grid" *ngIf="isStage(2)">
    <div class="usa-width-one-whole">
      <form class="usa-form form-otp" autocomplete="off" [formGroup]="form" (ngSubmit)="submit($event)">
        <legend class="usa-title">One time password</legend>
        <p>We take security seriously. We have sent you a one-time access code by email.</p>
        <fieldset>
          <div class="usa-input-error-message" *ngIf="isErrors() && states.submitted">{{ errors.global[0] }}</div>

          <div formGroupName="stage2" [ngClass]="{ 'usa-input-error': states.submitted && isStage(2) && form.controls.stage2.invalid }">
            <label for="signin-otp">Enter your one-time access code</label>
            <span class="usa-input-error-message" *ngIf="states.submitted && isStage(2) && form.controls.stage2.invalid" role="alert">
              Enter your one-time access code
            </span>
            <input type="password" id="signin-otp" formControlName="otp" />
          </div>

          <div>
            <button type="submit" [disabled]="states.loading">Submit</button>
          </div>

          <p class="usa-form-note">
            <a title="Return to Sign In"
               href="javascript:void(0);"
               class="usa-show_password"
               (click)="switchStage(1)">Return to Sign In</a>
          </p>
        </fieldset>
      </form>
    </div>
  </div>
</div>
