<page [section]="store.section" [title]="title" [badge]="status">
  <sidebar>
    <sam-sidenav type="step"
                 [model]="store.nav"
                 [labelLookup]="store.nav.children[states.section].label"
                 (path)="onNavigate($event)"></sam-sidenav>
  </sidebar>
  <div>
    <div class="header-hint" message [innerText]="message"></div>

    <sam-alert type="error" *ngIf="store.errors" [description]="store.errors"></sam-alert>

    <form [formGroup]="form" *ngIf="user && form">
      <sam-actions-dropdown [actions]="store.actions"></sam-actions-dropdown>

      <sam-tabs theme="separate" size="default" (currentSelectedTab)="onTab($event)">
        <sam-tab tabTitle="Edit" [active]="states.edit">
          <edit [section]="store.nav.children[states.section].route" [group]="form" #editTab></edit>
        </sam-tab>
        <sam-tab tabTitle="Review" [active]="states.review" [disabled]="false">
          <review class="review" [form]="form" (onEdit)="edit($event)" #reviewTab></review>
        </sam-tab>

        <ng-container *ngIf="states.review">
          <sam-tab tabTitle="Submit" [float]="true" *ngIf="!user.reviewer" [disabled]="form.valid"></sam-tab>
          <sam-tab tabTitle="Approve" [float]="true" *ngIf="user.reviewer"></sam-tab>
          <sam-tab tabTitle="Reject" class="last" [float]="true" *ngIf="user.reviewer"></sam-tab>
        </ng-container>
      </sam-tabs>
    </form>

    <div class="usa-button-controls" *ngIf="!states.review">
      <sam-button buttonType="tertiary" buttonSize="small" buttonText="Cancel" class="button-cancel" (onClick)="cancel()"></sam-button>
      <sam-button buttonType="secondary" buttonSize="small" buttonText="Previous" class="button-previous" (onClick)="previous()" *ngIf="states.section > 0"></sam-button>
      <sam-button buttonType="secondary" buttonSize="small" buttonText="Review" class="button-review" (onClick)="review()" *ngIf="states.section < store.nav.children.length - 1"></sam-button>
      <sam-button buttonType="primary" buttonSize="small" buttonText="Next" class="button-next" (onClick)="next()"></sam-button>
    </div>
  </div>
</page>
