<div class = "rolemgmt-content usa-grid-full ">
  <div>
    <div class="overview-header">
      <div class="usa-grid-full">
        <!--
        <div class="usa-width-five-twelfths">
          <h3>Select an Organization</h3>
          <sam-agency-picker [multimode]="false"></sam-agency-picker>
        </div>
        -->
        <div class="usa-width-one-fourth">
          <h3>Requests</h3>
          <div>
            <span class="badge-primary">{{escalatedCount}}</span>
            <a (click)="onEscalatedClick()">Escalated Requests</a>
          </div>
          <div class="m_T-2x">
            <span class="badge-primary">{{pendingCount}}</span>
            <a (click)="onPendingClick()">Pending Requests</a>
          </div>
        </div>
        <div class="usa-width-one-third">
          <h3>Favorite Organizations</h3>
          <div>
            <a>GSA</a>
          </div>
          <div>
            <a>Office of Management and Budget</a>
          </div>
        </div>
      </div>
      <div>
        <button class="usa-button-transparent back-to-workspace-button p_L-0" [routerLink]="'/'">
          <i class="fa fa-arrow-circle-left icn_pos" aria-hidden="true"></i>
          <span class = "inline-block">Back to Workspace Home</span>
        </button>
      </div>
    </div>
  </div>
  <div class = "usa-grid-full">
    <div class="p_T-3em">
      <div>
        <h2>Access Management
          <div class="pull-right">
            <strong class="sort-label">Sort (Requested Date)</strong>
            <sam-select
              class="sort-options"
              [(model)]="selectModel"
              [name]="'created-date-sort'"
              [options]="selectConfig.options"
              (modelChange)="onSelectChanged($event)">
            </sam-select>
          </div>
        </h2>
        <h3 class="showing-count">{{showingCountText()}}</h3>

      </div>
    </div>
  </div>
  <div *ngIf = "currCount < 1" >
    <em>No records were found</em>
  </div>
  <div *ngIf = "currCount > 0">
    <div  *ngFor = "let content of requestDetails" >
      <section class = "sec-bor">
        <div><span class="usa-label-big">{{content.domain}}</span></div>
        <div class="request-block">
          <div class="request-top-block">
            <div class="usa-grid-full clearfix">
              <div class="pull-right icon-and-respond">
                <i class="fa fa-2x" [ngClass]="classForRequest(content)"></i>
                <button *ngIf = "shouldShowRespondButton(content)" routerLink = "../requests/{{content.id}}" class="respond-button usa-button usa-button-primary m_T-0">Respond</button>
              </div>
              <div class="usa-width-one-third">
                <div><strong>Requested By</strong></div>
                <div>{{content.requestorName.toUpperCase()}}</div>
              </div>
              <div class="usa-width-one-third">
                <div><strong>Requested Date</strong></div>
                <div>{{formatDate(content.createdDate)}}</div>
              </div>
              <div class="usa-width-one-sixth">
                <div>
                  <strong>Status</strong>
                </div>
                <div>{{content.status}}</div>
              </div>
            </div>

            <div class="usa-grid-full m_T-2x">
              <!-- Pending -->
              <ng-container *ngIf="content.status.toLowerCase() === 'pending'">
                <div class="usa-width-one-third">
                  <div><strong>Supervisor Name</strong></div>
                  <div>{{content.supervisorName.toUpperCase()}}</div>
                </div>
                <div class="usa-width-one-third">
                  <div><strong>Supervisor Email</strong></div>
                  <div>{{content.supervisorEmail}}</div>
                </div>
              </ng-container>

              <!-- Escalated -->
              <ng-container *ngIf="content.status.toLowerCase() === 'escalated'">
                <div class="usa-width-one-third">
                  <div><strong>Escalated By</strong></div>
                  <div>{{content.escalatedTo}}</div>
                </div>
                <div class="usa-width-one-third">
                  <div><strong>Escalation Date</strong></div>
                  <div>{{formatDate(content.updatedDate)}}</div>
                </div>
                <div class="usa-width-one-third">
                  <div><strong>Escalated To</strong></div>
                  <div>---</div>
                </div>
              </ng-container>

              <!-- Rejected -->
              <ng-container *ngIf="content.status.toLowerCase() === 'rejected'">
                <div class="usa-width-one-third">
                  <div><strong>Rejected By</strong></div>
                  <div>---</div>
                </div>
                <div class="usa-width-one-third">
                  <div><strong>Rejection Date</strong></div>
                  <div>{{formatDate(content.updatedDate)}}</div>
                </div>
                <div class="usa-width-one-third">
                  <div><strong>Rejection Organization</strong></div>
                  <div>---</div>
                </div>
              </ng-container>

              <!-- Approved -->
              <ng-container *ngIf="content.status.toLowerCase() === 'approved'">
                <div class="usa-width-one-third">
                  <div><strong>Approved By</strong></div>
                  <div>---</div>
                </div>
                <div class="usa-width-one-third">
                  <div><strong>Approved Date</strong></div>
                  <div>{{formatDate(content.updatedDate)}}</div>
                </div>
                <div class="usa-width-one-third">
                  <div><strong>Approval Organization</strong></div>
                  <div>---</div>
                </div>
              </ng-container>
            </div>
          </div>

          <samAccordion>
            <sam-accordion-section [name]="'comments'" [headerText]="'Comments'">
              <section class="comment-section" *ngIf="content.requestorMessage">
                <div class="comment-user-icon">
                  <i class="fa fa-user"></i>
                </div>
                <div class="comment-user-name">
                  <strong>Requestor said:</strong>
                </div>
                <div class="comment">
                  {{content.requestorMessage}}
                </div>
              </section>
              <section class="comment-section" *ngIf="content.adminMessage">
                <div class="comment-user-icon">
                  <i class="fa fa-user"></i>
                </div>
                <div class="comment-user-name">
                  <strong>Admin said:</strong>
                </div>
                <div class="comment">
                  {{content.adminMessage}}
                </div>
              </section>
            </sam-accordion-section>
          </samAccordion>
          <samAccordion *ngIf='content.status.toLowerCase() === "approved"' class="details-accordion">
            <sam-accordion-section [name]="'details'" [headerText]="'Details'">
              <div class="usa-grid-full">
                <div class="usa-width-one-third">
                  <div><strong>Role Granted</strong></div>
                  <div>{{getRolesGranted(content)}}</div>
                </div>
                <div class="usa-width-two-thirds">
                  <div><strong>Organizations</strong></div>
                  <div>{{getOrganizations(content)}}</div>
                </div>
              </div>
            </sam-accordion-section>
          </samAccordion>
        </div>
      </section>
    </div>
  </div>
  <div class = "pag-com">
    <div *ngIf ="totalPages > 1">
      <sam-pagination [currentPage]="currPage" [totalPages]="totalPages" (pageChange)="onPageChange($event)"></sam-pagination>
    </div>
  </div>
</div>
