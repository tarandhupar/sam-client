<sam-modal #titleModal
           [showClose]="titleMissingConfig.showClose"
           [closeOnOutsideClick]="titleMissingConfig.closeOnOutsideClick"
           [closeOnEscape]="titleMissingConfig.closeOnEscape"
           [type]="'warning'"
           [title]="titleMissingConfig.title"
           [submitButtonLabel]="titleMissingConfig.confirmText"
           [cancelButtonLabel]="titleMissingConfig.cancelText"
           (onSubmit)="onTitleModalYesorClose()"
           (onClose)="onTitleModalNo()">
  <div [innerHTML]="titleMissingConfig.description"></div>
</sam-modal>

<form-step
  [ngClass]="'assistance-listing-operations'"
  [crumbs]="crumbs"
  [pageTitle]="falFormViewModel.title ? falFormViewModel.title : 'New Listing'"
  [sectionTitle]="falFormViewModel.title ? 'Assistance Listing' : 'Workspace'"
  [sideNavSelection]="sidenavSelection"
  [sideNavModel]="sidenavModel"
  [sectionIndex]="currentSection"
  [numberOfSections]="sections.length"
  [statusBannerLeadingText]="leadingErrorMsg"
  [hasErrors]="hasErrors"
  [tabsComponent]="tabsComponent"
  statusBannerType="warning"
  [(statusBannerExpanded)]="statusBannerExpanded"
  (action)="formActionHandler($event)"
  (sideNavOutput)="navHandler($event)"
  (breadcrumbOut)="breadCrumbClick($event)"
  [alerts] = "alerts">

  <div status-banner>
    <fal-error-display *ngIf="!isAdd" #errorDisplay
      (message)="updateLeadingMsg($event)"
      (onNavigation)="checkNavigation($event)">
    </fal-error-display>
  </div>

  <div form-sections>
    <check-active-assistance-administrator
      *ngIf="organizationData && falFormViewModel && falFormViewModel._links && falFormViewModel._links['program:notify:coordinator'] &&
      falFormViewModel.status && falFormViewModel.status.code && (falFormViewModel.status.code === 'draft' || falFormViewModel.status.code === 'draft_review' || falFormViewModel.status.code === 'rejected')"
      [organization]="organizationData">
    </check-active-assistance-administrator>

    <!-- Tabs -->
    <tabs-fal #tabsFalComponent
      [data]="falFormViewModel['_fal']"
      (tabClick)="tabsClicked($event)">
    </tabs-fal>

    <div class="sam-ui hidden divider"></div>

    <fal-form-header-information
      *ngIf="isSection('header-information')"
      [viewModel]="falFormViewModel"
      (showErrors)="showErrors($event)" #form>
    </fal-form-header-information>


    <fal-form-overview
      *ngIf="isSection('overview')"
      [viewModel]="falFormViewModel"
      (showErrors)="showErrors($event)" #form>
    </fal-form-overview>


    <fal-form-authorization
      *ngIf="isSection('authorization')"
      [viewModel]="falFormViewModel"
      (showErrors)="showErrors($event)" #form>
    </fal-form-authorization>


    <fal-form-obligation-info
      *ngIf="isSection('financial-information-obligations')"
      [viewModel]="falFormViewModel"
      (showErrors)="showErrors($event)" #form>
    </fal-form-obligation-info>


    <fal-form-financial-info-other
      *ngIf="isSection('financial-information-other')"
      [viewModel]="falFormViewModel"
      (showErrors)="showErrors($event)" #form>
    </fal-form-financial-info-other>


    <fal-form-criteria-info
      *ngIf="isSection('criteria-information')"
      [viewModel]="falFormViewModel"
      (showErrors)="showErrors($event)" #form>
    </fal-form-criteria-info>


    <fal-form-assistance
      *ngIf="isSection('applying-for-assistance')"
      [viewModel]="falFormViewModel"
      (showErrors)="showErrors($event)" #form>
    </fal-form-assistance>


    <fal-form-compliance-requirements
      *ngIf="isSection('compliance-requirements')"
      [viewModel]="falFormViewModel"
      (showErrors)="showErrors($event)" #form>
    </fal-form-compliance-requirements>


    <fal-form-contact-info
      *ngIf="isSection('contact-information')"
      [viewModel]="falFormViewModel"
      (showErrors)="showErrors($event)" #form>
    </fal-form-contact-info>

  </div>
</form-step>
