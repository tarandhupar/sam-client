<page
  *ngIf="pageReady"
  theme="inside"
  [attr.id]="'page-title'"
  [breadcrumbs]=""
  section="Workspace"
  [title]="pageTitle">

  <div class="sam-ui grid">
    <div class="twelve wide mobile eleven wide tablet seven wide computer column">
      <div id="page-data" class="sam-ui segment" *ngIf="program">
        <div class="sam-ui medium header">
          Title
          <div class="sub header">{{program.data.title}}</div>
        </div>
        <div class="sam-ui medium header">
          CFDA Number
          <div class="sub header">{{program.data.programNumber}}</div>
        </div>
      </div>

      <div class="sam-ui hidden divider"></div>

      <form [formGroup]="falChangeRequestForm">
        <div class="sam-ui segment">
          <ng-container *ngIf="requestType == 'archive_request'">
            <sam-checkbox class="cb-request"
                          [label]="'Have you verified there is $0 funding for two years(current and prior), and no active awards against this listing on USASpending.gov?*'"
                          [name] ="'active-awards'"
                          [attr.id]="'archive-checkbox'"
                          [options]="archiveRequestActiveAwardsOptions"
                          [hasSelectAll]="false"
                          [control]="falChangeRequestForm.controls['activeAwards']"
                          formControlName="activeAwards">
            </sam-checkbox>
          </ng-container>

          <ng-container *ngIf="program && (requestType == 'agency_request')">

            <sam-alert [type]="'error'" [title]="'Same Agency'" *ngIf="falChangeRequestForm.controls['organizationPicker'].hasError('error')">
              The chosen agency is the same as the current one. Please choose a different agency.
            </sam-alert>

            <h4 class="sam-ui header">Current Organization</h4>

            <div class="sam-ui medium header" *ngIf="currentOrganization.l1Name">
              Department
              <div class="sub header">{{currentOrganization.l1Name}}</div>
            </div>
            <div class="sam-ui medium header" *ngIf="currentOrganization.l2Name">
              Sub-Tier
              <div class="sub header">{{currentOrganization.l2Name}}</div>
            </div>
            <div class="sam-ui medium header" *ngIf="currentOrganization.l3Name">
              Office
              <div class="sub header">{{currentOrganization.l3Name}}</div>
            </div>

            <sam-agency-picker
              [label]="'New Agency'"
              [multimode]="false"
              [advancedMode]="false"
              [required]="true"
              (organization)="onOrganizationChange($event)"
              [levelLimit]='3'
              formControlName="organizationPicker">
            </sam-agency-picker>
            <sam-alert [type]="'warning'" [title]="'Agency outside of your users scope'" *ngIf="agencyChangeAlertShow">
              The chosen agency is outside your users scope. If you continue and this request is approved, you will no longer have access to this program.
            </sam-alert>
          </ng-container>

          <sam-fal-text *ngIf="requestType == 'program_number_request' && cfdaCode"
                    [maxlength]="3"
                    [control]="falChangeRequestForm.controls['programNumber']"
                    [name]="'program-number-input'"
                    [label]="'Proposed CFDA Number*'"
                    [required]="true"
                    [cfdaCode]="cfdaCode"
                    [pending]="falChangeRequestForm.controls['programNumber'].pending"
                    formControlName="programNumber">
          </sam-fal-text>

          <sam-text *ngIf="requestType == 'title_request'"
                    [control]="falChangeRequestForm.controls['newTitle']"
                    [name]="'new-title-input'"
                    [label]="'New Title*'"
                    [required]="true"
                    formControlName="newTitle">
          </sam-text>

          <sam-text-area [label]="'Comment*'"
                         [name]="'comment-input'"
                         [control]="falChangeRequestForm.controls['comment']"
                         [required]="true"
                         formControlName="comment">
          </sam-text-area>
        </div>

        <sam-button [buttonType]="buttonType"
                    [attr.id]="'submit-btn'"
                    [buttonText]="submitButtonText"
                    [buttonClass]="'usa-button-primary usa-search-submit search-btn'"
                    (onClick)="submitChangeRequest()">
        </sam-button>
        <sam-button [buttonType]="buttonType"
                    [attr.id]="'cancel-btn'"
                    [buttonText]="'Cancel'"
                    [buttonClass]="'usa-button-primary usa-search-submit'"
                    (onClick)="cancelChangeRequest()">
        </sam-button>

      </form>
    </div>
  </div>

  <div class="sam-ui hidden section divider"></div>

</page>
