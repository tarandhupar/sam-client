<div #feedbackRoot class="sam-feedback">

  <sam-modal [showClose]="false" #proceedModal [title]="modalConfig.title" [type]="modalConfig.type" [description]="modalConfig.description" [submitButtonLabel]="'Confirm'" [cancelButtonLabel]="'Cancel'" (onSubmit)="onProceedModalConfirm()" (onClose)="onProceedModalClose()"  [closeOnOutsideClick]="false">
  </sam-modal>

  <div class="feedback-form-div feedback-question-thanks usa-grid text-align-center" *ngIf="showThanksNote">
    <h1 class="m_T-6x"><i class="fa fa-comments"></i></h1>
    <h1>Thank You for Your Feedback!</h1>
    <div class="usa-width-one-whole">
      <span>Window will automatically close in: {{curSec}}s </span>
    </div>
    <div class="usa-width-one-whole m_T-3x m_B-3x">
      <span><button class="usa-button-primary" (click)="stopCountDown()">Close</button></span>
    </div>
    <div class="usa-width-one-whole text-align-center m_B-3x">
      <a class="usa-nav-link feedback-form-link"  fragment="OMB" (click)="OnOMBlinkClick()">Form Approved OMB#3090-0297 Exp. Date 07/31/2019</a>
    </div>
  </div>

  <div *ngIf="showFeedback && !showThanksNote" class="feedback-form-div relative">

    <div class="usa-grid-full feedback-header">
      <i class="fa fa-comments" aria-hidden="true"></i>
      &nbsp;Provide Feedback
    </div>
    <div class="usa-width-one-whole feedback-question-div">
      <div class="usa-width-one-whole">
        <samAccordion>
          <div *ngFor="let qItem of questionData; let i = index" class="relative">
            <sam-accordion-section [headerText]="qItem.description" [name]="qItem.description" [isExpanded]="i === 0" (isExpandedChange)="onExpandChange($event, i)">
              <!--Rating Question-->
              <div class="feedback-question-rating m_T-2x" *ngIf="checkQType('rating',qItem)">
                <span class="usa-width-one-half m_R-0 feedback-icon-font"><i class="fa {{ratingThumbUpClass}} thumb" aria-hidden="true" (click)="onRatingClick(true, i)"></i></span>
                <span class="usa-width-one-half feedback-icon-font"><i class="fa {{ratingThumbDownClass}} thumb" aria-hidden="true" (click)="onRatingClick(false, i)"></i></span>
              </div>

              <!--Checkbox Question-->
              <div class="feedback-question-checkbox m_T-2x usa-grid-full" *ngIf="checkQType('multiSelection',qItem)">
                <div class="usa-width-one-half m_R-0 m_B-1x p_L-7x" *ngFor="let option of qItem.selections">
                  <input class="usa-width-one-half" type="checkbox" (change)="onCbxChange(option, $event.target.checked, i)" [(ngModel)]="multiSelectionModel[option]"><label class="m_T-0">{{option}}</label>
                </div>
              </div>

              <!--Radio Button Question-->
              <div class="feedback-question-radio m_T-2x usa-grid" *ngIf="checkQType('singleSelection',qItem)">
                <div class="usa-width-one-half m_B-1x p_L-7x m_R-0" *ngFor="let option of qItem.selections">
                  <input class="usa-width-one-fourth" type="radio" (change)="onRadioBtnChange(option, i)" [checked]="radioBtnValue === option"><label class="m_T-0 marginCenter" (click)="onRadioBtnChange(option,i)">{{option}}</label>
                </div>
              </div>

              <!--TextBox Question-->
              <div class="feedback-question-textarea m_T-2x usa-grid-full" *ngIf="checkQType('textarea',qItem)">
                <textarea class="usa-width-one-whole m_L-7x" name="text" rows="3" placeholder="Leave us a comment" (change)="onTextAreaChange(i)" [(ngModel)]="textAreaModel"></textarea>
              </div>

              <!--Radio Email Question-->
              <div class="feedback-question-fin m_T-2x m_B-2x usa-grid" *ngIf="checkQType('radio-text',qItem) && !showThanksNote">
                <div class="usa-width-one-third">
                  <div class="usa-offset-one-fourth usa-width-three-fourths m_B-2x">
                    <input class="usa-width-one-fourth" type="radio" (change)="onEmailRadioBtnChange('Yes', i)" [checked]="isEmailBtnChecked('Yes')"><label class="m_T-0 marginCenter" (click)="onEmailRadioBtnChange('Yes', i)">Yes</label>
                  </div>
                  <div class="usa-offset-one-fourth usa-width-three-fourths">
                    <input class="usa-width-one-fourth" type="radio" (change)="onEmailRadioBtnChange('No', i)" [checked]="isEmailBtnChecked('No')"><label class="m_T-0 marginCenter" (click)="onEmailRadioBtnChange('No', i)">No</label>
                  </div>
                </div>

                <div class="usa-width-two-thirds">
                  <div class="usa-width-one-whole m_R-0">
                    <div [ngClass]="{'usa-input-error':showEmailError}">
                      <span *ngIf="emailRadioBtnValue === 'Yes'">Email address</span>
                      <span class="usa-input-error-message" *ngIf="showEmailError">Please enter a valid email address</span>
                      <input aria-describedby="input-error-message" type="email" id="email" name="email" [formControl]="email" class="usa-width-one-whole feedback-email-input" *ngIf="emailRadioBtnValue === 'Yes'" [(ngModel)]="userEmailModel" (change)="onEmailTextChange(i)">
                    </div>
                  </div>
                </div>
              </div>


            </sam-accordion-section>
            <span class="feedback-check-icon">
              <i class="fa fa-check-circle" *ngIf="answerData[i].edited"></i>
              <i class="fa fa-circle-thin" *ngIf="!answerData[i].edited"></i>
            </span>
          </div>
        </samAccordion>
      </div>
    </div>
    <div class="usa-width-one-whole feedback-footer">
      <div class="usa-offset-one-fourth usa-width-one-half">
        <button class="usa-button-primary pull-left" (click)="toggleFeedback()">Cancel</button>
        <button class="usa-button-primary pull-right" (click)="onSubmitFeedbackClick()">Submit</button>
      </div>
      <div class="usa-width-one-whole text-align-center">
        <a class="usa-nav-link feedback-form-link"  fragment="OMB" (click)="OnOMBlinkClick()">Form Approved OMB#3090-0297 Exp. Date 07/31/2019</a>
      </div>
    </div>
  </div>

</div>
